
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Getting Started &#8212; pyepal v0.1.7+22.gc8be9f0.dirty documentation</title>

  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">


  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">



  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">


    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />

  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Background" href="background.html" />
    <link rel="prev" title="PyePAL: Pareto active learning for Python" href="index.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">


    <div class="container-xl">
      <div class="row">

<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">

        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">

  <img src="_static/pyepal_logo.png" class="logo" alt="logo">


  <h1 class="site-logo" id="site-title">pyepal v0.1.7+22.gc8be9f0.dirty documentation</h1>

</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="background.html">
   Background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tutorials.html">
   Tutorials
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api.html">
   The PyePAL API reference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="developer_notes.html">
   Developer notes
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>






<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">

    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">

        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>


<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->

        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/getting_started.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kjappelbaum/pyepal"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kjappelbaum/pyepal/issues/new?title=Issue%20on%20page%20%2Fgetting_started.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/kjappelbaum/pyepal/edit/master/docs/getting_started.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">

        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation">
   Installation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#which-class-do-i-use">
   Which class do i use?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-an-active-learning-experiment">
   Running an active learning experiment
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hyperparameter-optimization">
     Hyperparameter optimization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#logging">
     Logging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#properties-of-the-pal-object">
     Properties of the PAL object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exploring-a-space-where-all-objectives-are-known">
     Exploring a space where all objectives are known
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#batch-sampling">
     Batch sampling
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#caveats-and-tricks-with-gaussian-processes">
   Caveats and tricks with Gaussian processes
  </a>
 </li>
</ul>

        </nav>

    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">

              <div>

  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>We recommend installing PyePAL in a dedicated <a class="reference external" href="https://docs.python.org/3/tutorial/venv.html">virtual environment</a> or <a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">conda environment</a>.</p>
<p>To install the latest stable release use</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install pyepal
</pre></div>
</div>
<p>The latest version of PyePAL can be installed from GitHub using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install git+https://github.com/kjappelbaum/pyepal.git
</pre></div>
</div>
</div>
<div class="section" id="which-class-do-i-use">
<h2>Which class do i use?<a class="headerlink" href="#which-class-do-i-use" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>For Gaussian processes built with <code class="code docutils literal notranslate"><span class="pre">sklearn</span></code> use <a class="reference internal" href="api.html#pyepal.pal.pal_sklearn.PALSklearn" title="pyepal.pal.pal_sklearn.PALSklearn"><code class="xref py py-class docutils literal notranslate"><span class="pre">PALSklearn</span></code></a></p></li>
<li><p>For Gaussian processes built with <code class="code docutils literal notranslate"><span class="pre">GPy</span></code> use <a class="reference internal" href="api.html#pyepal.pal.pal_gpy.PALGPy" title="pyepal.pal.pal_gpy.PALGPy"><code class="xref py py-class docutils literal notranslate"><span class="pre">PALGPy</span></code></a></p></li>
<li><p>For coregionalized Gaussian processes (built with <code class="code docutils literal notranslate"><span class="pre">GPy</span></code>) use <a class="reference internal" href="api.html#pyepal.pal.pal_coregionalized.PALCoregionalized" title="pyepal.pal.pal_coregionalized.PALCoregionalized"><code class="xref py py-class docutils literal notranslate"><span class="pre">PALCoregionalized</span></code></a></p></li>
<li><p>For quantile regression using <code class="code docutils literal notranslate"><span class="pre">LightGBM</span></code> gradient boosted decision trees use <a class="reference internal" href="api.html#pyepal.pal.pal_gbdt.PALGBDT" title="pyepal.pal.pal_gbdt.PALGBDT"><code class="xref py py-class docutils literal notranslate"><span class="pre">PALGBDT</span></code></a></p></li>
</ul>
<p>If your favorite model is not listed, you can easily implement it yourself (see <a class="reference internal" href="developer_notes.html#new-pal-class"><span class="std std-ref">Implementing a new PAL class</span></a>)!</p>
</div>
<div class="section" id="running-an-active-learning-experiment">
<h2>Running an active learning experiment<a class="headerlink" href="#running-an-active-learning-experiment" title="Permalink to this headline">¶</a></h2>
<p>The <cite>examples</cite> directory contains a <a class="reference external" href="https://github.com/kjappelbaum/pyepal/blob/master/examples/test_pal.ipynb">Jupyter notebook with an example</a> that can also be run on MyBinder.</p>
<p>If using a Gaussian process model built with <code class="code docutils literal notranslate"><span class="pre">sklearn</span></code> or <code class="code docutils literal notranslate"><span class="pre">GPy</span></code> we recommend using a pre-built class such as <a class="reference internal" href="api.html#pyepal.pal.pal_sklearn.PALSklearn" title="pyepal.pal.pal_sklearn.PALSklearn"><code class="xref py py-class docutils literal notranslate"><span class="pre">PALSklearn</span></code></a>,  <a class="reference internal" href="api.html#pyepal.pal.pal_coregionalized.PALCoregionalized" title="pyepal.pal.pal_coregionalized.PALCoregionalized"><code class="xref py py-class docutils literal notranslate"><span class="pre">PALCoregionalized</span></code></a>,  <a class="reference internal" href="api.html#pyepal.pal.pal_gpy.PALGPy" title="pyepal.pal.pal_gpy.PALGPy"><code class="xref py py-class docutils literal notranslate"><span class="pre">PALGPy</span></code></a> and following the subsequent steps (for more details on which class to use see <a class="reference internal" href="#which-class-do-i-use"><span class="std std-ref">Which class do i use?</span></a>):</p>
<ol class="arabic">
<li><p>For each objective create a model (if using a coregionalized Gaussian process model, only one model needs to be created)</p></li>
<li><p>Sample a few initial points from the design space. We provide the <a class="reference internal" href="api.html#pyepal.pal.utils.get_maxmin_samples" title="pyepal.pal.utils.get_maxmin_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_maxmin_samples()</span></code></a> or <a class="reference internal" href="api.html#pyepal.pal.utils.get_kmeans_samples" title="pyepal.pal.utils.get_kmeans_samples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_kmeans_samples()</span></code></a> utilities that can help with the sampling. Our code assumes that <code class="code docutils literal notranslate"><span class="pre">X</span></code> is a <code class="code docutils literal notranslate"><span class="pre">np.array</span></code>.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyepal</span> <span class="kn">import</span> <span class="n">get_kmeans_samples</span><span class="p">,</span> <span class="n">get_maxmin_samples</span>

<span class="c1"># This selects the 10 points closest to the centroids of a k=10 means clustering</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">get_kmeans_samples</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># This selects the 10 farthest points in feature space</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">get_maxmin_samples</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Now we can initialize the instance of one <code class="code docutils literal notranslate"><span class="pre">PAL</span></code> class. If using a <code class="code docutils literal notranslate"><span class="pre">sklearn</span></code> Gaussian process model, we would use</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyepal</span> <span class="kn">import</span> <span class="n">PALSklearn</span>

<span class="c1"># Each of these models is an instance of sklearn.gaussian_process.GaussianProcessRegressor</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">gpr0</span><span class="p">,</span> <span class="n">gpr1</span><span class="p">,</span> <span class="n">gpr2</span><span class="p">]</span>

<span class="c1"># We always need to provide the feature matrix (X), a list of models, and the number of objectives</span>
<span class="n">palinstance</span> <span class="o">=</span> <span class="n">PALSklearn</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Now, we can also feed in the first measurements</span>
<span class="c1"># this here assumes that we have all measurements for y and we now</span>
<span class="c1"># provide those which are present in the indices array</span>
<span class="n">palinstance</span><span class="o">.</span><span class="n">update_train_set</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="n">indices</span><span class="p">])</span>

<span class="c1"># Now we can run one step</span>
<span class="n">next_idx</span> <span class="o">=</span> <span class="n">palinstance</span><span class="o">.</span><span class="n">run_one_step</span><span class="p">()</span>
</pre></div>
</div>
<p>At this level, we have a range of different optional arguements we can set.</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">epsilon</span></code>: one <span class="math notranslate nohighlight">\(\epsilon\)</span> per dimension in a <code class="code docutils literal notranslate"><span class="pre">np.ndarray</span></code>. This can be used to set different tolerances for each objective. Note that <span class="math notranslate nohighlight">\(\epsilon_i \in [0,1]\)</span>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">delta</span></code>: the <span class="math notranslate nohighlight">\(\delta\)</span> hyperparameter (<span class="math notranslate nohighlight">\(\delta \in [0,1]\)</span>). Increasing this value will speed up the convergence.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">beta_scale</span></code>: an empirical scaling parameter for <span class="math notranslate nohighlight">\(\beta\)</span>. The theoretical guarantees in the PAL paper are derived for this parameter set to 1. But in practice, a much faster convergence can be achieved by setting it to a number <span class="math notranslate nohighlight">\(0&lt; \beta_\mathrm{scale} \ll 1\)</span>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">goal</span></code>: By default, PyePAL assumes that the goal is to maximize every objective. If this is not the case, this argument can be set using a list of “min” and “max” strings, with “min” specifying whether to minimize the ith objective and “max” indicating whether to maximize this objective.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">coef_var_threshold</span></code>: By default, PyePAL will not consider points with a coefficient of variation <span class="math notranslate nohighlight">\(\ge 3\)</span> for the classification step of the algorithm. This is meant to avoid classifying design points for which the model is entirely unsure. This tends to happen when a model is severely overfit on the training data (i.e., the training data uncertainties are very low, whereas the prediction uncertainties are very high). To change this setting, reduce this value to make the check tighter or increase it to avoid this check (as in the original implementation).</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<p>In the case of missing observations, i.e., only two of three outputs are measured, report the missing observations as <code class="code docutils literal notranslate"><span class="pre">np.nan</span></code>. The call could look like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">palinstance</span><span class="o">.</span><span class="n">update_train_set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]))</span>
</pre></div>
</div>
<p>for a case in which we performed measurements for samples with index 1 and 2 of our design space, but did not measure the first target for sample 2.</p>
<div class="section" id="hyperparameter-optimization">
<h3>Hyperparameter optimization<a class="headerlink" href="#hyperparameter-optimization" title="Permalink to this headline">¶</a></h3>
<p>Usually, the hyperparameters of a machine learning model, in particular the kernel hyperparameters of a Gaussian process regression model, should be optimized as new training data is added.
However, since this is usually a computationally expensive process, it may not be desirable to perform this at every iteration of the active learning process. The iteration frequency of the hyperparameter optimization is internally set by the <code class="code docutils literal notranslate"><span class="pre">_should_optimize_hyperparameters</span></code> function, which by default uses a schedule that optimizes the hyperparameter every 10th iteration. This behavior can be changed by override this function.</p>
</div>
<div class="section" id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<p>Basic information such as the current iteration and the classification status are logged and can be viewed by printing the <code class="code docutils literal notranslate"><span class="pre">PAL</span></code> object</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">palinstance</span><span class="p">)</span>

<span class="c1"># returns: pyepal at iteration 1. 10 Pareto optimal points, 1304 discarded points, 200 unclassified points.</span>
</pre></div>
</div>
<p>We also provide calculation of the hypervolume enclosed by the Pareto front with the function <a class="reference internal" href="api.html#pyepal.pal.utils.get_hypervolume" title="pyepal.pal.utils.get_hypervolume"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_hypervolume()</span></code></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hv</span> <span class="o">=</span> <span class="n">get_hypervolume</span><span class="p">(</span><span class="n">palinstance</span><span class="o">.</span><span class="n">means</span><span class="p">[</span><span class="n">palinstance</span><span class="o">.</span><span class="n">pareto_optimal</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="properties-of-the-pal-object">
<h3>Properties of the PAL object<a class="headerlink" href="#properties-of-the-pal-object" title="Permalink to this headline">¶</a></h3>
<p>For debugging there are some properties and attributes of the <cite>PAL</cite> class that can be used to inspect the progress of the active learning loop.</p>
<ul class="simple">
<li><dl class="simple">
<dt>get the points in the design space, <code class="code docutils literal notranslate"><span class="pre">x</span></code>:</dt><dd><ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">design_space</span></code> returns the full design space matrix</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">pareto_optimal_points</span></code>: returns the points that are classified as Pareto-efficient</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">sampled_points</span></code>: returns the points that have been sampled</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">discarded_points</span></code>: returns the points that have been discarded</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>get the indices of Pareto efficent, sampled,  discarded, and unclassified points with <code class="code docutils literal notranslate"><span class="pre">pareto_optimal_indices</span></code>, <code class="code docutils literal notranslate"><span class="pre">sampled_indices</span></code>, <code class="code docutils literal notranslate"><span class="pre">discarded_indices</span></code>, and <code class="code docutils literal notranslate"><span class="pre">unclassified_indices</span></code></p></li>
<li><p>similarly, the number of points in the different classes can be obtained using <code class="code docutils literal notranslate"><span class="pre">number_pareto_optimal_points</span></code>, <code class="code docutils literal notranslate"><span class="pre">number_discarded_points</span></code>, <code class="code docutils literal notranslate"><span class="pre">number_unclassified_points</span></code>, and <code class="code docutils literal notranslate"><span class="pre">number_sampled_points</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">hyperrectangle_size</span></code> returns the sizes of the hyperrectangles, i.e., the weights that are used in the sampling step</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">means</span></code> and <code class="code docutils literal notranslate"><span class="pre">std</span></code> contain the predictions of the model</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">sampled</span></code> is a mask array. In case one objective has not been measured its cell is <code class="code docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ul>
</div>
<div class="section" id="exploring-a-space-where-all-objectives-are-known">
<h3>Exploring a space where all objectives are known<a class="headerlink" href="#exploring-a-space-where-all-objectives-are-known" title="Permalink to this headline">¶</a></h3>
<p>In some cases, we may already posess all measurements, but would like to run PAL with different settings to test how the algorithm performs.
In this case, we provide the <a class="reference internal" href="api.html#pyepal.pal.utils.exhaust_loop" title="pyepal.pal.utils.exhaust_loop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exhaust_loop()</span></code></a> wrapper.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyepal</span> <span class="kn">import</span> <span class="n">PALSklearn</span><span class="p">,</span> <span class="n">exhaust_loop</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">gpr0</span><span class="p">,</span> <span class="n">gpr1</span><span class="p">,</span> <span class="n">gpr2</span><span class="p">]</span>
<span class="n">palinstance</span> <span class="o">=</span> <span class="n">PALSklearn</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">exhaust_loop</span><span class="p">(</span><span class="n">palinstance</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>This will continue calling <code class="code docutils literal notranslate"><span class="pre">run_one_step()</span></code> until there is no unclassified sample left.</p>
</div>
<div class="section" id="batch-sampling">
<h3>Batch sampling<a class="headerlink" href="#batch-sampling" title="Permalink to this headline">¶</a></h3>
<p>By default, the <code class="code docutils literal notranslate"><span class="pre">run_one_step</span></code> function of the PAL classes will return a <code class="code docutils literal notranslate"><span class="pre">np.ndarray</span></code> with only one index for the point in the design space for which the next experiment should be performed. In some situations, it may be more practical to run multiple experiments as batches before running the next active learning iteration. In such cases, we provide the <code class="code docutils literal notranslate"><span class="pre">batch_size</span></code> argument which can be set to an integer greater than one.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">next_idx</span> <span class="o">=</span> <span class="n">palinstance</span><span class="o">.</span><span class="n">run_one_step</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># next_idx will be a np.array of length 10</span>
</pre></div>
</div>
<p>Note that the <cite>exhaust_loop</cite> also supports the <cite>batch_size</cite> keyword argument</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">palinstance</span> <span class="o">=</span> <span class="n">PALSklearn</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">models</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># sample always 10 points and do this until there is no unclassified</span>
<span class="c1"># point left</span>
<span class="n">exhaust_loop</span><span class="p">(</span><span class="n">palinstance</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="caveats-and-tricks-with-gaussian-processes">
<h2>Caveats and tricks with Gaussian processes<a class="headerlink" href="#caveats-and-tricks-with-gaussian-processes" title="Permalink to this headline">¶</a></h2>
<p>One caveat to keep in mind is that <span class="math notranslate nohighlight">\(\epsilon\)</span>-PAL will not work if the predictive variance does not make sense, for example, when the model is overconfident and the uncertainties for the training set is significantly lower than those for the predicted set. In this case, PyePAL will untimely, and often incorrectly, label the design points. An example situation where the predictions for an overconfident model due to a training set that excludes a part of design space is shown in the figure below</p>
<a class="reference internal image-reference" href="_images/overconfident_model.png"><img alt="Example of the predictions of an overconfident GPR model" src="_images/overconfident_model.png" style="width: 600px;" /></a>
<p>This problem is exacerbated in conjunction with <span class="math notranslate nohighlight">\(\beta_\mathrm{scale} &lt; 1\)</span>. To make the model more robust we suggest trying:</p>
<ul class="simple">
<li><p>to set reasonable bounds on the length scale parameters</p></li>
<li><p>to increase the regularization parameter/noise kernel (<code class="code docutils literal notranslate"><span class="pre">alpha</span></code> in <code class="code docutils literal notranslate"><span class="pre">sklearn</span></code>)</p></li>
<li><p>to increase the number of data points, especially the coverage of the design space</p></li>
<li><p><a class="reference external" href="https://www.cs.toronto.edu/~duvenaud/cookbook/">to use a kernel that suits the problem</a></p></li>
<li><p>to turn off ARD. Automatic relevance determination (ARD) might increase the predictive performance, but also makes the model more prone to overfitting</p></li>
</ul>
<p>We also recommend cross-validating the Gaussian process models and checking that the predicted variances make sense. When performing cross-validation, make sure that the index provided to PyePAL is the same size as the cross-validation folds.
By default, the code will run a simple cross-validation only on the first iteration and provide a warning if the mean absolute error is above the mean standard deviation. The warning will look something like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">mean</span> <span class="n">absolute</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">cross</span><span class="o">-</span><span class="n">validation</span> <span class="ow">is</span> <span class="mf">64.29</span><span class="p">,</span> <span class="n">the</span> <span class="n">mean</span> <span class="n">variance</span> <span class="ow">is</span> <span class="mf">0.36</span><span class="o">.</span>
<span class="n">Your</span> <span class="n">model</span> <span class="n">might</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">predictive</span> <span class="ow">and</span><span class="o">/</span><span class="ow">or</span> <span class="n">overconfident</span><span class="o">.</span>
<span class="n">In</span> <span class="n">the</span> <span class="n">docs</span><span class="p">,</span> <span class="n">you</span> <span class="n">find</span> <span class="n">hints</span> <span class="n">on</span> <span class="n">how</span> <span class="n">to</span> <span class="n">make</span> <span class="n">GPRs</span> <span class="n">more</span> <span class="n">robust</span><span class="o">.</span>
</pre></div>
</div>
<p>This behavior can changed with the cross-validation test being performed more frequently by overriding the <code class="code docutils literal notranslate"><span class="pre">should_run_crossvalidation</span></code> function.</p>
<p>Another way to detect overfitting is to use <a class="reference internal" href="api.html#pyepal.plotting.plot_jointplot" title="pyepal.plotting.plot_jointplot"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_jointplot()</span></code></a> function from the plotting subpackage. This function will plot all objectives against each other (with errorbars and different classes indicated with colors) and histograms of the objectives on the diagonal. If the majority of predicted points tend to overlap one another and get discarded by PyePAL, this may suggest that the surrogate model is overfitted.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyepal.plotting</span> <span class="kn">import</span> <span class="n">plot_jointplot</span>

<span class="c1"># palinstance is a instance of a PAL class after</span>
<span class="c1"># calling run_one_step</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plot_jointplot</span><span class="p">(</span><span class="n">palinstance</span><span class="o">.</span><span class="n">means</span><span class="p">,</span> <span class="n">palinstance</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/jointplot_example.png"><img alt="Example of the output of plot_jointplot" src="_images/jointplot_example.png" style="width: 600px;" /></a>
</div>
</div>


              </div>

        </div>
    </div>


    <div class='prev-next-bottom'>

    <a class='left-prev' id="prev-link" href="index.html" title="previous page">PyePAL: Pareto active learning for Python</a>
    <a class='right-next' id="next-link" href="background.html" title="next page">Background</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>

          By Kevin Maik Jablonka, Brian Yoo, Berend Smit<br/>

            &copy; Copyright 2020, Kevin Maik Jablonka, Brian Yoo, Berend Smit.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>


  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>



  </body>
</html>
